# k8s/secrets/external-secrets/service-account.yaml
# =============================================================================
# ServiceAccount for External Secrets Operator with Azure Workload Identity
# =============================================================================
# This ServiceAccount is used by the External Secrets Operator to authenticate
# with Azure Key Vault using Workload Identity Federation.
#
# PREREQUISITES:
# 1. Azure Managed Identity created (see docs/azure-setup.md)
# 2. Federated Credential configured linking this ServiceAccount to the identity
# 3. External Secrets Operator installed in the cluster
#
# REQUIRED CONFIGURATION:
# - Replace ${MANAGED_IDENTITY_CLIENT_ID} with your actual Azure Managed Identity Client ID
# =============================================================================
apiVersion: v1
kind: ServiceAccount
metadata:
  name: external-secrets-sa
  namespace: external-secrets
  labels:
    app.kubernetes.io/name: external-secrets
    app.kubernetes.io/component: service-account
    azure.workload.identity/use: "true"
  annotations:
    # Azure Workload Identity - Replace with your actual Client ID
    # Get this value from: az identity show --name external-secrets-identity --resource-group <rg> --query clientId -o tsv
    azure.workload.identity/client-id: "5a3a3720-0e80-4f21-ad4d-108c28a54c9e"
